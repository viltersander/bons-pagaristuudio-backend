{
  "version": 3,
  "sources": ["../../spark-md5/spark-md5.js", "../../@segment/analytics-next/src/core/arguments-resolver/index.ts", "../../@segment/analytics-next/src/core/events/index.ts", "../../@segment/analytics-next/src/core/queue/event-queue.ts", "../../@segment/analytics-next/src/core/analytics/index.ts", "../../@segment/analytics-next/src/lib/get-process-env.ts", "../../@segment/analytics-next/src/lib/create-deferred.ts", "../../@segment/analytics-next/src/lib/pick.ts", "../../@segment/analytics-next/src/plugins/page-enrichment/index.ts", "../../@segment/analytics-next/src/plugins/remote-loader/index.ts", "../../@segment/analytics-next/src/lib/on-page-leave.ts", "../../@segment/analytics-next/src/plugins/segmentio/batched-dispatcher.ts", "../../@segment/analytics-next/src/plugins/segmentio/fetch-dispatcher.ts", "../../@segment/analytics-next/src/plugins/segmentio/schedule-flush.ts", "../../@segment/analytics-next/src/plugins/segmentio/index.ts", "../../@segment/analytics-next/src/plugins/validation/index.ts", "../../@segment/analytics-next/src/lib/is-thenable.ts", "../../@segment/analytics-next/src/core/buffer/index.ts", "../../@segment/analytics-next/src/core/buffer/snippet.ts", "../../@segment/analytics-next/src/core/inspector/index.ts", "../../@segment/analytics-next/src/browser/index.ts", "../../@segment/analytics-next/src/node/node.browser.ts"],
  "sourcesContent": ["(function (factory) {\n    if (typeof exports === 'object') {\n        // Node/CommonJS\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD\n        define(factory);\n    } else {\n        // Browser globals (with support for web workers)\n        var glob;\n\n        try {\n            glob = window;\n        } catch (e) {\n            glob = self;\n        }\n\n        glob.SparkMD5 = factory();\n    }\n}(function (undefined) {\n\n    'use strict';\n\n    /*\n     * Fastest md5 implementation around (JKM md5).\n     * Credits: Joseph Myers\n     *\n     * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n     * @see http://jsperf.com/md5-shootout/7\n     */\n\n    /* this function is much faster,\n      so if possible we use it. Some IEs\n      are the only ones I know of that\n      need the idiotic second function,\n      generated by an if clause.  */\n    var add32 = function (a, b) {\n        return (a + b) & 0xFFFFFFFF;\n    },\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\n\n\n    function cmn(q, a, b, x, s, t) {\n        a = add32(add32(a, q), add32(x, t));\n        return add32((a << s) | (a >>> (32 - s)), b);\n    }\n\n    function md5cycle(x, k) {\n        var a = x[0],\n            b = x[1],\n            c = x[2],\n            d = x[3];\n\n        a += (b & c | ~b & d) + k[0] - 680876936 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[1] - 389564586 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[2] + 606105819 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[3] - 1044525330 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[4] - 176418897 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[5] + 1200080426 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[6] - 1473231341 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[7] - 45705983 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[8] + 1770035416 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[9] - 1958414417 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[10] - 42063 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[11] - 1990404162 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n        a += (b & c | ~b & d) + k[12] + 1804603682 | 0;\n        a  = (a << 7 | a >>> 25) + b | 0;\n        d += (a & b | ~a & c) + k[13] - 40341101 | 0;\n        d  = (d << 12 | d >>> 20) + a | 0;\n        c += (d & a | ~d & b) + k[14] - 1502002290 | 0;\n        c  = (c << 17 | c >>> 15) + d | 0;\n        b += (c & d | ~c & a) + k[15] + 1236535329 | 0;\n        b  = (b << 22 | b >>> 10) + c | 0;\n\n        a += (b & d | c & ~d) + k[1] - 165796510 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[6] - 1069501632 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[11] + 643717713 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[0] - 373897302 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[5] - 701558691 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[10] + 38016083 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[15] - 660478335 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[4] - 405537848 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[9] + 568446438 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[14] - 1019803690 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[3] - 187363961 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[8] + 1163531501 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n        a += (b & d | c & ~d) + k[13] - 1444681467 | 0;\n        a  = (a << 5 | a >>> 27) + b | 0;\n        d += (a & c | b & ~c) + k[2] - 51403784 | 0;\n        d  = (d << 9 | d >>> 23) + a | 0;\n        c += (d & b | a & ~b) + k[7] + 1735328473 | 0;\n        c  = (c << 14 | c >>> 18) + d | 0;\n        b += (c & a | d & ~a) + k[12] - 1926607734 | 0;\n        b  = (b << 20 | b >>> 12) + c | 0;\n\n        a += (b ^ c ^ d) + k[5] - 378558 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[8] - 2022574463 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[11] + 1839030562 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[14] - 35309556 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[1] - 1530992060 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[4] + 1272893353 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[7] - 155497632 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[10] - 1094730640 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[13] + 681279174 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[0] - 358537222 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[3] - 722521979 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[6] + 76029189 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n        a += (b ^ c ^ d) + k[9] - 640364487 | 0;\n        a  = (a << 4 | a >>> 28) + b | 0;\n        d += (a ^ b ^ c) + k[12] - 421815835 | 0;\n        d  = (d << 11 | d >>> 21) + a | 0;\n        c += (d ^ a ^ b) + k[15] + 530742520 | 0;\n        c  = (c << 16 | c >>> 16) + d | 0;\n        b += (c ^ d ^ a) + k[2] - 995338651 | 0;\n        b  = (b << 23 | b >>> 9) + c | 0;\n\n        a += (c ^ (b | ~d)) + k[0] - 198630844 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[7] + 1126891415 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[14] - 1416354905 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[5] - 57434055 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[12] + 1700485571 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[3] - 1894986606 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[10] - 1051523 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[1] - 2054922799 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[8] + 1873313359 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[15] - 30611744 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[6] - 1560198380 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[13] + 1309151649 | 0;\n        b  = (b << 21 |b >>> 11) + c | 0;\n        a += (c ^ (b | ~d)) + k[4] - 145523070 | 0;\n        a  = (a << 6 | a >>> 26) + b | 0;\n        d += (b ^ (a | ~c)) + k[11] - 1120210379 | 0;\n        d  = (d << 10 | d >>> 22) + a | 0;\n        c += (a ^ (d | ~b)) + k[2] + 718787259 | 0;\n        c  = (c << 15 | c >>> 17) + d | 0;\n        b += (d ^ (c | ~a)) + k[9] - 343485551 | 0;\n        b  = (b << 21 | b >>> 11) + c | 0;\n\n        x[0] = a + x[0] | 0;\n        x[1] = b + x[1] | 0;\n        x[2] = c + x[2] | 0;\n        x[3] = d + x[3] | 0;\n    }\n\n    function md5blk(s) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n        }\n        return md5blks;\n    }\n\n    function md5blk_array(a) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n        }\n        return md5blks;\n    }\n\n    function md51(s) {\n        var n = s.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk(s.substring(i - 64, i)));\n        }\n        s = s.substring(i - 64);\n        length = s.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n        }\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n        return state;\n    }\n\n    function md51_array(a) {\n        var n = a.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n        }\n\n        // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n        // containing the last element of the parent array if the sub array specified starts\n        // beyond the length of the parent array - weird.\n        // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n        a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n        length = a.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= a[i] << ((i % 4) << 3);\n        }\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n\n        return state;\n    }\n\n    function rhex(n) {\n        var s = '',\n            j;\n        for (j = 0; j < 4; j += 1) {\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n        }\n        return s;\n    }\n\n    function hex(x) {\n        var i;\n        for (i = 0; i < x.length; i += 1) {\n            x[i] = rhex(x[i]);\n        }\n        return x.join('');\n    }\n\n    // In some cases the fast add32 function cannot be used..\n    if (hex(md51('hello')) !== '5d41402abc4b2a76b9719d911017c592') {\n        add32 = function (x, y) {\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n            return (msw << 16) | (lsw & 0xFFFF);\n        };\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * ArrayBuffer slice polyfill.\n     *\n     * @see https://github.com/ttaubert/node-arraybuffer-slice\n     */\n\n    if (typeof ArrayBuffer !== 'undefined' && !ArrayBuffer.prototype.slice) {\n        (function () {\n            function clamp(val, length) {\n                val = (val | 0) || 0;\n\n                if (val < 0) {\n                    return Math.max(val + length, 0);\n                }\n\n                return Math.min(val, length);\n            }\n\n            ArrayBuffer.prototype.slice = function (from, to) {\n                var length = this.byteLength,\n                    begin = clamp(from, length),\n                    end = length,\n                    num,\n                    target,\n                    targetArray,\n                    sourceArray;\n\n                if (to !== undefined) {\n                    end = clamp(to, length);\n                }\n\n                if (begin > end) {\n                    return new ArrayBuffer(0);\n                }\n\n                num = end - begin;\n                target = new ArrayBuffer(num);\n                targetArray = new Uint8Array(target);\n\n                sourceArray = new Uint8Array(this, begin, num);\n                targetArray.set(sourceArray);\n\n                return target;\n            };\n        })();\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * Helpers.\n     */\n\n    function toUtf8(str) {\n        if (/[\\u0080-\\uFFFF]/.test(str)) {\n            str = unescape(encodeURIComponent(str));\n        }\n\n        return str;\n    }\n\n    function utf8Str2ArrayBuffer(str, returnUInt8Array) {\n        var length = str.length,\n           buff = new ArrayBuffer(length),\n           arr = new Uint8Array(buff),\n           i;\n\n        for (i = 0; i < length; i += 1) {\n            arr[i] = str.charCodeAt(i);\n        }\n\n        return returnUInt8Array ? arr : buff;\n    }\n\n    function arrayBuffer2Utf8Str(buff) {\n        return String.fromCharCode.apply(null, new Uint8Array(buff));\n    }\n\n    function concatenateArrayBuffers(first, second, returnUInt8Array) {\n        var result = new Uint8Array(first.byteLength + second.byteLength);\n\n        result.set(new Uint8Array(first));\n        result.set(new Uint8Array(second), first.byteLength);\n\n        return returnUInt8Array ? result : result.buffer;\n    }\n\n    function hexToBinaryString(hex) {\n        var bytes = [],\n            length = hex.length,\n            x;\n\n        for (x = 0; x < length - 1; x += 2) {\n            bytes.push(parseInt(hex.substr(x, 2), 16));\n        }\n\n        return String.fromCharCode.apply(String, bytes);\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation.\n     *\n     * Use this class to perform an incremental md5, otherwise use the\n     * static methods instead.\n     */\n\n    function SparkMD5() {\n        // call reset to init the instance\n        this.reset();\n    }\n\n    /**\n     * Appends a string.\n     * A conversion will be applied if an utf8 string is detected.\n     *\n     * @param {String} str The string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.append = function (str) {\n        // Converts the string to utf8 bytes if necessary\n        // Then append as binary\n        this.appendBinary(toUtf8(str));\n\n        return this;\n    };\n\n    /**\n     * Appends a binary string.\n     *\n     * @param {String} contents The binary string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.appendBinary = function (contents) {\n        this._buff += contents;\n        this._length += contents.length;\n\n        var length = this._buff.length,\n            i;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk(this._buff.substring(i - 64, i)));\n        }\n\n        this._buff = this._buff.substring(i - 64);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            i,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.reset = function () {\n        this._buff = '';\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.prototype.getState = function () {\n        return {\n            buff: this._buff,\n            length: this._length,\n            hash: this._hash.slice()\n        };\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.setState = function (state) {\n        this._buff = state.buff;\n        this._length = state.length;\n        this._hash = state.hash;\n\n        return this;\n    };\n\n    /**\n     * Releases memory used by the incremental buffer and other additional\n     * resources. If you plan to use the instance again, use reset instead.\n     */\n    SparkMD5.prototype.destroy = function () {\n        delete this._hash;\n        delete this._buff;\n        delete this._length;\n    };\n\n    /**\n     * Finish the final calculation based on the tail.\n     *\n     * @param {Array}  tail   The tail (will be modified)\n     * @param {Number} length The length of the remaining buffer\n     */\n    SparkMD5.prototype._finish = function (tail, length) {\n        var i = length,\n            tmp,\n            lo,\n            hi;\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(this._hash, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Do the final computation based on the tail and length\n        // Beware that the final length may not fit in 32 bits so we take care of that\n        tmp = this._length * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n        md5cycle(this._hash, tail);\n    };\n\n    /**\n     * Performs the md5 hash on a string.\n     * A conversion will be applied if utf8 string is detected.\n     *\n     * @param {String}  str The string\n     * @param {Boolean} [raw] True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hash = function (str, raw) {\n        // Converts the string to utf8 bytes if necessary\n        // Then compute it using the binary function\n        return SparkMD5.hashBinary(toUtf8(str), raw);\n    };\n\n    /**\n     * Performs the md5 hash on a binary string.\n     *\n     * @param {String}  content The binary string\n     * @param {Boolean} [raw]     True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hashBinary = function (content, raw) {\n        var hash = md51(content),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation for array buffers.\n     *\n     * Use this class to perform an incremental md5 ONLY for array buffers.\n     */\n    SparkMD5.ArrayBuffer = function () {\n        // call reset to init the instance\n        this.reset();\n    };\n\n    /**\n     * Appends an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array to be appended\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n        var buff = concatenateArrayBuffers(this._buff.buffer, arr, true),\n            length = buff.length,\n            i;\n\n        this._length += arr.byteLength;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk_array(buff.subarray(i - 64, i)));\n        }\n\n        this._buff = (i - 64) < length ? new Uint8Array(buff.buffer.slice(i - 64)) : new Uint8Array(0);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            i,\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.reset = function () {\n        this._buff = new Uint8Array(0);\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.ArrayBuffer.prototype.getState = function () {\n        var state = SparkMD5.prototype.getState.call(this);\n\n        // Convert buffer to a string\n        state.buff = arrayBuffer2Utf8Str(state.buff);\n\n        return state;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.setState = function (state) {\n        // Convert string to buffer\n        state.buff = utf8Str2ArrayBuffer(state.buff, true);\n\n        return SparkMD5.prototype.setState.call(this, state);\n    };\n\n    SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n    SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n    /**\n     * Performs the md5 hash on an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array buffer\n     * @param {Boolean}     [raw] True to get the raw string, false to get the hex one\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n        var hash = md51_array(new Uint8Array(arr)),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    return SparkMD5;\n}));\n", "import {\n  isFunction,\n  isPlainObject,\n  isString,\n  isNumber,\n} from '@segment/analytics-core'\nimport { Context } from '../context'\nimport {\n  Callback,\n  JSONObject,\n  Options,\n  EventProperties,\n  SegmentEvent,\n  Traits,\n  GroupTraits,\n  UserTraits,\n} from '../events'\nimport { ID, User } from '../user'\n\n/**\n * Helper for the track method\n */\nexport function resolveArguments(\n  eventName: string | SegmentEvent,\n  properties?: EventProperties | Callback,\n  options?: Options | Callback,\n  callback?: Callback\n): [string, EventProperties | Callback, Options, Callback | undefined] {\n  const args = [eventName, properties, options, callback]\n\n  const name = isPlainObject(eventName) ? eventName.event : eventName\n  if (!name || !isString(name)) {\n    throw new Error('Event missing')\n  }\n\n  const data = isPlainObject(eventName)\n    ? eventName.properties ?? {}\n    : isPlainObject(properties)\n    ? properties\n    : {}\n\n  let opts: Options = {}\n  if (!isFunction(options)) {\n    opts = options ?? {}\n  }\n\n  if (isPlainObject(eventName) && !isFunction(properties)) {\n    opts = properties ?? {}\n  }\n\n  const cb = args.find(isFunction) as Callback | undefined\n  return [name, data, opts, cb]\n}\n\n/**\n * Helper for page, screen methods\n */\nexport function resolvePageArguments(\n  category?: string | object,\n  name?: string | object | Callback,\n  properties?: EventProperties | Options | Callback | null,\n  options?: Options | Callback,\n  callback?: Callback\n): [\n  string | null,\n  string | null,\n  EventProperties,\n  Options,\n  Callback | undefined\n] {\n  let resolvedCategory: string | undefined | null = null\n  let resolvedName: string | undefined | null = null\n  const args = [category, name, properties, options, callback]\n\n  const strings = args.filter(isString)\n  if (strings[0] !== undefined && strings[1] !== undefined) {\n    resolvedCategory = strings[0]\n    resolvedName = strings[1]\n  }\n\n  if (strings.length === 1) {\n    resolvedCategory = null\n    resolvedName = strings[0]\n  }\n\n  const resolvedCallback = args.find(isFunction) as Callback | undefined\n\n  const objects = args.filter((obj) => {\n    if (resolvedName === null) {\n      return isPlainObject(obj)\n    }\n    return isPlainObject(obj) || obj === null\n  }) as Array<JSONObject | null>\n\n  const resolvedProperties = (objects[0] ?? {}) as EventProperties\n  const resolvedOptions = (objects[1] ?? {}) as Options\n\n  return [\n    resolvedCategory,\n    resolvedName,\n    resolvedProperties,\n    resolvedOptions,\n    resolvedCallback,\n  ]\n}\n\n/**\n * Helper for group, identify methods\n */\nexport const resolveUserArguments = <T extends Traits, U extends User>(\n  user: U\n): ResolveUser<T> => {\n  return (...args): ReturnType<ResolveUser<T>> => {\n    let id: string | ID | null = null\n    id = args.find(isString) ?? args.find(isNumber)?.toString() ?? user.id()\n\n    const objects = args.filter((obj) => {\n      if (id === null) {\n        return isPlainObject(obj)\n      }\n      return isPlainObject(obj) || obj === null\n    }) as Array<Traits | null>\n\n    const traits = (objects[0] ?? {}) as T\n    const opts = (objects[1] ?? {}) as Options\n\n    const resolvedCallback = args.find(isFunction) as Callback | undefined\n\n    return [id, traits, opts, resolvedCallback]\n  }\n}\n\n/**\n * Helper for alias method\n */\nexport function resolveAliasArguments(\n  to: string | number,\n  from?: string | number | Options,\n  options?: Options | Callback,\n  callback?: Callback\n): [string, string | null, Options, Callback | undefined] {\n  if (isNumber(to)) to = to.toString() // Legacy behaviour - allow integers for alias calls\n  if (isNumber(from)) from = from.toString()\n  const args = [to, from, options, callback]\n\n  const [aliasTo = to, aliasFrom = null] = args.filter(isString)\n  const [opts = {}] = args.filter(isPlainObject)\n  const resolvedCallback = args.find(isFunction) as Callback | undefined\n\n  return [aliasTo, aliasFrom, opts, resolvedCallback]\n}\n\ntype ResolveUser<T extends Traits> = (\n  id?: ID | object,\n  traits?: T | Callback | null,\n  options?: Options | Callback,\n  callback?: Callback\n) => [ID, T, Options, Callback | undefined]\n\nexport type IdentifyParams = Parameters<ResolveUser<UserTraits>>\nexport type GroupParams = Parameters<ResolveUser<GroupTraits>>\nexport type EventParams = Parameters<typeof resolveArguments>\nexport type PageParams = Parameters<typeof resolvePageArguments>\nexport type AliasParams = Parameters<typeof resolveAliasArguments>\n\nexport type DispatchedEvent = Context\n", "import { v4 as uuid } from '@lukeed/uuid'\nimport { dset } from 'dset'\nimport { ID, User } from '../user'\nimport {\n  Options,\n  Integrations,\n  EventProperties,\n  Traits,\n  SegmentEvent,\n} from './interfaces'\nimport md5 from 'spark-md5'\n\nexport * from './interfaces'\n\nexport class EventFactory {\n  user: User\n\n  constructor(user: User) {\n    this.user = user\n  }\n\n  track(\n    event: string,\n    properties?: EventProperties,\n    options?: Options,\n    globalIntegrations?: Integrations\n  ): SegmentEvent {\n    return this.normalize({\n      ...this.baseEvent(),\n      event,\n      type: 'track' as const,\n      properties,\n      options: { ...options },\n      integrations: { ...globalIntegrations },\n    })\n  }\n\n  page(\n    category: string | null,\n    page: string | null,\n    properties?: EventProperties,\n    options?: Options,\n    globalIntegrations?: Integrations\n  ): SegmentEvent {\n    const event: Partial<SegmentEvent> = {\n      type: 'page' as const,\n      properties: { ...properties },\n      options: { ...options },\n      integrations: { ...globalIntegrations },\n    }\n\n    if (category !== null) {\n      event.category = category\n      event.properties = event.properties ?? {}\n      event.properties.category = category\n    }\n\n    if (page !== null) {\n      event.name = page\n    }\n\n    return this.normalize({\n      ...this.baseEvent(),\n      ...event,\n    } as SegmentEvent)\n  }\n\n  screen(\n    category: string | null,\n    screen: string | null,\n    properties?: EventProperties,\n    options?: Options,\n    globalIntegrations?: Integrations\n  ): SegmentEvent {\n    const event: Partial<SegmentEvent> = {\n      type: 'screen' as const,\n      properties: { ...properties },\n      options: { ...options },\n      integrations: { ...globalIntegrations },\n    }\n\n    if (category !== null) {\n      event.category = category\n    }\n\n    if (screen !== null) {\n      event.name = screen\n    }\n\n    return this.normalize({\n      ...this.baseEvent(),\n      ...event,\n    } as SegmentEvent)\n  }\n\n  identify(\n    userId: ID,\n    traits?: Traits,\n    options?: Options,\n    globalIntegrations?: Integrations\n  ): SegmentEvent {\n    return this.normalize({\n      ...this.baseEvent(),\n      type: 'identify' as const,\n      userId,\n      traits,\n      options: { ...options },\n      integrations: { ...globalIntegrations },\n    })\n  }\n\n  group(\n    groupId: ID,\n    traits?: Traits,\n    options?: Options,\n    globalIntegrations?: Integrations\n  ): SegmentEvent {\n    return this.normalize({\n      ...this.baseEvent(),\n      type: 'group' as const,\n      traits,\n      options: { ...options },\n      integrations: { ...globalIntegrations },\n      groupId,\n    })\n  }\n\n  alias(\n    to: string,\n    from: string | null,\n    options?: Options,\n    globalIntegrations?: Integrations\n  ): SegmentEvent {\n    const base: Partial<SegmentEvent> = {\n      userId: to,\n      type: 'alias' as const,\n      options: { ...options },\n      integrations: { ...globalIntegrations },\n    }\n\n    if (from !== null) {\n      base.previousId = from\n    }\n\n    if (to === undefined) {\n      return this.normalize({\n        ...base,\n        ...this.baseEvent(),\n      } as SegmentEvent)\n    }\n\n    return this.normalize({\n      ...this.baseEvent(),\n      ...base,\n    } as SegmentEvent)\n  }\n\n  private baseEvent(): Partial<SegmentEvent> {\n    const base: Partial<SegmentEvent> = {\n      integrations: {},\n      options: {},\n    }\n\n    const user = this.user\n\n    if (user.id()) {\n      base.userId = user.id()\n    }\n\n    if (user.anonymousId()) {\n      base.anonymousId = user.anonymousId()\n    }\n\n    return base\n  }\n\n  /**\n   * Builds the context part of an event based on \"foreign\" keys that\n   * are provided in the `Options` parameter for an Event\n   */\n  private context(event: SegmentEvent): [object, object] {\n    const optionsKeys = ['integrations', 'anonymousId', 'timestamp', 'userId']\n\n    const options = event.options ?? {}\n    delete options['integrations']\n\n    const providedOptionsKeys = Object.keys(options)\n\n    const context = event.options?.context ?? {}\n    const overrides = {}\n\n    providedOptionsKeys.forEach((key) => {\n      if (key === 'context') {\n        return\n      }\n\n      if (optionsKeys.includes(key)) {\n        dset(overrides, key, options[key])\n      } else {\n        dset(context, key, options[key])\n      }\n    })\n\n    return [context, overrides]\n  }\n\n  public normalize(event: SegmentEvent): SegmentEvent {\n    // set anonymousId globally if we encounter an override\n    //segment.com/docs/connections/sources/catalog/libraries/website/javascript/identity/#override-the-anonymous-id-using-the-options-object\n    event.options?.anonymousId &&\n      this.user.anonymousId(event.options.anonymousId)\n\n    const integrationBooleans = Object.keys(event.integrations ?? {}).reduce(\n      (integrationNames, name) => {\n        return {\n          ...integrationNames,\n          [name]: Boolean(event.integrations?.[name]),\n        }\n      },\n      {} as Record<string, boolean>\n    )\n\n    // This is pretty trippy, but here's what's going on:\n    // - a) We don't pass initial integration options as part of the event, only if they're true or false\n    // - b) We do accept per integration overrides (like integrations.Amplitude.sessionId) at the event level\n    // Hence the need to convert base integration options to booleans, but maintain per event integration overrides\n    const allIntegrations = {\n      // Base config integrations object as booleans\n      ...integrationBooleans,\n\n      // Per event overrides, for things like amplitude sessionId, for example\n      ...event.options?.integrations,\n    }\n\n    const [context, overrides] = this.context(event)\n    const { options, ...rest } = event\n\n    const body = {\n      timestamp: new Date(),\n      ...rest,\n      context,\n      integrations: allIntegrations,\n      ...overrides,\n    }\n\n    const messageId = 'ajs-next-' + md5.hash(JSON.stringify(body) + uuid())\n\n    const evt: SegmentEvent = {\n      ...body,\n      messageId,\n    }\n\n    return evt\n  }\n}\n", "import { PriorityQueue } from '../../lib/priority-queue'\nimport { PersistedPriorityQueue } from '../../lib/priority-queue/persisted'\nimport { Context } from '../context'\nimport { AnyBrowserPlugin } from '../plugin'\nimport { CoreEventQueue } from '@segment/analytics-core'\nimport { isOffline } from '../connection'\n\nexport class EventQueue extends CoreEventQueue<Context, AnyBrowserPlugin> {\n  constructor(priorityQueue?: PriorityQueue<Context>) {\n    super(priorityQueue ?? new PersistedPriorityQueue(4, 'event-queue'))\n  }\n  async flush(): Promise<Context[]> {\n    if (isOffline()) return []\n    return super.flush()\n  }\n}\n", "import {\n  AliasParams,\n  DispatchedEvent,\n  EventParams,\n  GroupParams,\n  PageParams,\n  resolveAliasArguments,\n  resolveArguments,\n  resolvePageArguments,\n  resolveUserArguments,\n  IdentifyParams,\n} from '../arguments-resolver'\nimport type { FormArgs, LinkArgs } from '../auto-track'\nimport { isOffline } from '../connection'\nimport { Context } from '../context'\nimport { dispatch, Emitter } from '@segment/analytics-core'\nimport {\n  Callback,\n  EventFactory,\n  Integrations,\n  Plan,\n  EventProperties,\n  SegmentEvent,\n} from '../events'\nimport type { Plugin } from '../plugin'\nimport { EventQueue } from '../queue/event-queue'\nimport {\n  CookieOptions,\n  getAvailableStorageOptions,\n  Group,\n  ID,\n  UniversalStorage,\n  User,\n  UserOptions,\n} from '../user'\nimport autoBind from '../../lib/bind-all'\nimport { PersistedPriorityQueue } from '../../lib/priority-queue/persisted'\nimport type { LegacyDestination } from '../../plugins/ajs-destination'\nimport type {\n  LegacyIntegration,\n  ClassicIntegrationSource,\n} from '../../plugins/ajs-destination/types'\nimport type {\n  DestinationMiddlewareFunction,\n  MiddlewareFunction,\n} from '../../plugins/middleware'\nimport { version } from '../../generated/version'\nimport { PriorityQueue } from '../../lib/priority-queue'\nimport { getGlobal } from '../../lib/get-global'\nimport { AnalyticsClassic, AnalyticsCore } from './interfaces'\n\nconst deprecationWarning =\n  'This is being deprecated and will be not be available in future releases of Analytics JS'\n\n// reference any pre-existing \"analytics\" object so a user can restore the reference\nconst global: any = getGlobal()\nconst _analytics = global?.analytics\n\nfunction createDefaultQueue(retryQueue = false, disablePersistance = false) {\n  const maxAttempts = retryQueue ? 4 : 1\n  const priorityQueue = disablePersistance\n    ? new PriorityQueue(maxAttempts, [])\n    : new PersistedPriorityQueue(maxAttempts, 'event-queue')\n  return new EventQueue(priorityQueue)\n}\n\nexport interface AnalyticsSettings {\n  writeKey: string\n  timeout?: number\n  plugins?: Plugin[]\n  classicIntegrations?: ClassicIntegrationSource[]\n}\n\nexport interface InitOptions {\n  /**\n   * Disables storing any data on the client-side via cookies or localstorage.\n   * Defaults to `false`.\n   *\n   */\n  disableClientPersistence?: boolean\n  /**\n   * Disables automatically converting ISO string event properties into Dates.\n   * ISO string to Date conversions occur right before sending events to a classic device mode integration,\n   * after any destination middleware have been ran.\n   * Defaults to `false`.\n   */\n  disableAutoISOConversion?: boolean\n  initialPageview?: boolean\n  cookie?: CookieOptions\n  user?: UserOptions\n  group?: UserOptions\n  integrations?: Integrations\n  plan?: Plan\n  retryQueue?: boolean\n  obfuscate?: boolean\n  /**\n   * Disables or sets constraints on processing of query string parameters\n   */\n  useQueryString?:\n    | boolean\n    | {\n        aid?: RegExp\n        uid?: RegExp\n      }\n}\n\n/* analytics-classic stubs */\nfunction _stub(this: never) {\n  console.warn(deprecationWarning)\n}\n\nexport class Analytics\n  extends Emitter\n  implements AnalyticsCore, AnalyticsClassic\n{\n  protected settings: AnalyticsSettings\n  private _user: User\n  private _group: Group\n  private eventFactory: EventFactory\n  private _debug = false\n  private _universalStorage: UniversalStorage<{\n    [k: string]: unknown\n  }>\n\n  initialized = false\n  integrations: Integrations\n  options: InitOptions\n  queue: EventQueue\n\n  constructor(\n    settings: AnalyticsSettings,\n    options?: InitOptions,\n    queue?: EventQueue,\n    user?: User,\n    group?: Group\n  ) {\n    super()\n    const cookieOptions = options?.cookie\n    const disablePersistance = options?.disableClientPersistence ?? false\n    this.settings = settings\n    this.settings.timeout = this.settings.timeout ?? 300\n    this.queue =\n      queue ?? createDefaultQueue(options?.retryQueue, disablePersistance)\n\n    this._universalStorage = new UniversalStorage(\n      disablePersistance ? ['memory'] : ['localStorage', 'cookie', 'memory'],\n      getAvailableStorageOptions(cookieOptions)\n    )\n\n    this._user =\n      user ??\n      new User(\n        disablePersistance\n          ? { ...options?.user, persist: false }\n          : options?.user,\n        cookieOptions\n      ).load()\n    this._group =\n      group ??\n      new Group(\n        disablePersistance\n          ? { ...options?.group, persist: false }\n          : options?.group,\n        cookieOptions\n      ).load()\n    this.eventFactory = new EventFactory(this._user)\n    this.integrations = options?.integrations ?? {}\n    this.options = options ?? {}\n\n    autoBind(this)\n  }\n\n  user = (): User => {\n    return this._user\n  }\n\n  get storage(): UniversalStorage {\n    return this._universalStorage\n  }\n\n  async track(...args: EventParams): Promise<DispatchedEvent> {\n    const [name, data, opts, cb] = resolveArguments(...args)\n\n    const segmentEvent = this.eventFactory.track(\n      name,\n      data as EventProperties,\n      opts,\n      this.integrations\n    )\n\n    return this._dispatch(segmentEvent, cb).then((ctx) => {\n      this.emit('track', name, ctx.event.properties, ctx.event.options)\n      return ctx\n    })\n  }\n\n  async page(...args: PageParams): Promise<DispatchedEvent> {\n    const [category, page, properties, options, callback] =\n      resolvePageArguments(...args)\n\n    const segmentEvent = this.eventFactory.page(\n      category,\n      page,\n      properties,\n      options,\n      this.integrations\n    )\n\n    return this._dispatch(segmentEvent, callback).then((ctx) => {\n      this.emit('page', category, page, ctx.event.properties, ctx.event.options)\n      return ctx\n    })\n  }\n\n  async identify(...args: IdentifyParams): Promise<DispatchedEvent> {\n    const [id, _traits, options, callback] = resolveUserArguments(this._user)(\n      ...args\n    )\n\n    this._user.identify(id, _traits)\n    const segmentEvent = this.eventFactory.identify(\n      this._user.id(),\n      this._user.traits(),\n      options,\n      this.integrations\n    )\n\n    return this._dispatch(segmentEvent, callback).then((ctx) => {\n      this.emit(\n        'identify',\n        ctx.event.userId,\n        ctx.event.traits,\n        ctx.event.options\n      )\n      return ctx\n    })\n  }\n\n  group(): Group\n  group(...args: GroupParams): Promise<DispatchedEvent>\n  group(...args: GroupParams): Promise<DispatchedEvent> | Group {\n    if (args.length === 0) {\n      return this._group\n    }\n\n    const [id, _traits, options, callback] = resolveUserArguments(this._group)(\n      ...args\n    )\n\n    this._group.identify(id, _traits)\n    const groupId = this._group.id()\n    const groupTraits = this._group.traits()\n\n    const segmentEvent = this.eventFactory.group(\n      groupId,\n      groupTraits,\n      options,\n      this.integrations\n    )\n\n    return this._dispatch(segmentEvent, callback).then((ctx) => {\n      this.emit('group', ctx.event.groupId, ctx.event.traits, ctx.event.options)\n      return ctx\n    })\n  }\n\n  async alias(...args: AliasParams): Promise<DispatchedEvent> {\n    const [to, from, options, callback] = resolveAliasArguments(...args)\n    const segmentEvent = this.eventFactory.alias(\n      to,\n      from,\n      options,\n      this.integrations\n    )\n    return this._dispatch(segmentEvent, callback).then((ctx) => {\n      this.emit('alias', to, from, ctx.event.options)\n      return ctx\n    })\n  }\n\n  async screen(...args: PageParams): Promise<DispatchedEvent> {\n    const [category, page, properties, options, callback] =\n      resolvePageArguments(...args)\n\n    const segmentEvent = this.eventFactory.screen(\n      category,\n      page,\n      properties,\n      options,\n      this.integrations\n    )\n    return this._dispatch(segmentEvent, callback).then((ctx) => {\n      this.emit(\n        'screen',\n        category,\n        page,\n        ctx.event.properties,\n        ctx.event.options\n      )\n      return ctx\n    })\n  }\n\n  async trackClick(...args: LinkArgs): Promise<Analytics> {\n    const autotrack = await import(\n      /* webpackChunkName: \"auto-track\" */ '../auto-track'\n    )\n    return autotrack.link.call(this, ...args)\n  }\n\n  async trackLink(...args: LinkArgs): Promise<Analytics> {\n    const autotrack = await import(\n      /* webpackChunkName: \"auto-track\" */ '../auto-track'\n    )\n    return autotrack.link.call(this, ...args)\n  }\n\n  async trackSubmit(...args: FormArgs): Promise<Analytics> {\n    const autotrack = await import(\n      /* webpackChunkName: \"auto-track\" */ '../auto-track'\n    )\n    return autotrack.form.call(this, ...args)\n  }\n\n  async trackForm(...args: FormArgs): Promise<Analytics> {\n    const autotrack = await import(\n      /* webpackChunkName: \"auto-track\" */ '../auto-track'\n    )\n    return autotrack.form.call(this, ...args)\n  }\n\n  async register(...plugins: Plugin[]): Promise<Context> {\n    const ctx = Context.system()\n\n    const registrations = plugins.map((xt) =>\n      this.queue.register(ctx, xt, this)\n    )\n    await Promise.all(registrations)\n\n    return ctx\n  }\n\n  async deregister(...plugins: string[]): Promise<Context> {\n    const ctx = Context.system()\n\n    const deregistrations = plugins.map((pl) => {\n      const plugin = this.queue.plugins.find((p) => p.name === pl)\n      if (plugin) {\n        return this.queue.deregister(ctx, plugin, this)\n      } else {\n        ctx.log('warn', `plugin ${pl} not found`)\n      }\n    })\n\n    await Promise.all(deregistrations)\n\n    return ctx\n  }\n\n  debug(toggle: boolean): Analytics {\n    // Make sure legacy ajs debug gets turned off if it was enabled before upgrading.\n    if (toggle === false && localStorage.getItem('debug')) {\n      localStorage.removeItem('debug')\n    }\n    this._debug = toggle\n    return this\n  }\n\n  reset(): void {\n    this._user.reset()\n    this._group.reset()\n    this.emit('reset')\n  }\n\n  timeout(timeout: number): void {\n    this.settings.timeout = timeout\n  }\n\n  private async _dispatch(\n    event: SegmentEvent,\n    callback?: Callback\n  ): Promise<DispatchedEvent> {\n    const ctx = new Context(event)\n    if (isOffline() && !this.options.retryQueue) {\n      return ctx\n    }\n    return dispatch(ctx, this.queue, this, {\n      callback,\n      debug: this._debug,\n      timeout: this.settings.timeout,\n    })\n  }\n\n  async addSourceMiddleware(fn: MiddlewareFunction): Promise<Analytics> {\n    await this.queue.criticalTasks.run(async () => {\n      const { sourceMiddlewarePlugin } = await import(\n        /* webpackChunkName: \"middleware\" */ '../../plugins/middleware'\n      )\n\n      const integrations: Record<string, boolean> = {}\n      this.queue.plugins.forEach((plugin) => {\n        if (plugin.type === 'destination') {\n          return (integrations[plugin.name] = true)\n        }\n      })\n\n      const plugin = sourceMiddlewarePlugin(fn, integrations)\n      await this.register(plugin)\n    })\n\n    return this\n  }\n\n  /* TODO: This does not have to return a promise? */\n  addDestinationMiddleware(\n    integrationName: string,\n    ...middlewares: DestinationMiddlewareFunction[]\n  ): Promise<Analytics> {\n    const legacyDestinations = this.queue.plugins.filter(\n      (xt) => xt.name.toLowerCase() === integrationName.toLowerCase()\n    ) as LegacyDestination[]\n\n    legacyDestinations.forEach((destination) => {\n      destination.addMiddleware(...middlewares)\n    })\n    return Promise.resolve(this)\n  }\n\n  setAnonymousId(id?: string): ID {\n    return this._user.anonymousId(id)\n  }\n\n  async queryString(query: string): Promise<Context[]> {\n    if (this.options.useQueryString === false) {\n      return []\n    }\n\n    const { queryString } = await import(\n      /* webpackChunkName: \"queryString\" */ '../query-string'\n    )\n    return queryString(this, query)\n  }\n\n  /**\n   * @deprecated This function does not register a destination plugin.\n   *\n   * Instantiates a legacy Analytics.js destination.\n   *\n   * This function does not register the destination as an Analytics.JS plugin,\n   * all the it does it to invoke the factory function back.\n   */\n  use(legacyPluginFactory: (analytics: Analytics) => void): Analytics {\n    legacyPluginFactory(this)\n    return this\n  }\n\n  async ready(\n    callback: Function = (res: Promise<unknown>[]): Promise<unknown>[] => res\n  ): Promise<unknown> {\n    return Promise.all(\n      this.queue.plugins.map((i) => (i.ready ? i.ready() : Promise.resolve()))\n    ).then((res) => {\n      callback(res)\n      return res\n    })\n  }\n\n  // analytics-classic api\n\n  noConflict(): Analytics {\n    console.warn(deprecationWarning)\n    window.analytics = _analytics ?? this\n    return this\n  }\n\n  normalize(msg: SegmentEvent): SegmentEvent {\n    console.warn(deprecationWarning)\n    return this.eventFactory.normalize(msg)\n  }\n\n  get failedInitializations(): string[] {\n    console.warn(deprecationWarning)\n    return this.queue.failedInitializations\n  }\n\n  get VERSION(): string {\n    return version\n  }\n\n  /* @deprecated - noop */\n  async initialize(\n    _settings?: AnalyticsSettings,\n    _options?: InitOptions\n  ): Promise<Analytics> {\n    console.warn(deprecationWarning)\n    return Promise.resolve(this)\n  }\n\n  init = this.initialize.bind(this)\n\n  async pageview(url: string): Promise<Analytics> {\n    console.warn(deprecationWarning)\n    await this.page({ path: url })\n    return this\n  }\n\n  get plugins() {\n    console.warn(deprecationWarning)\n    // @ts-expect-error\n    return this._plugins ?? {}\n  }\n\n  get Integrations() {\n    console.warn(deprecationWarning)\n    const integrations = this.queue.plugins\n      .filter((plugin) => plugin.type === 'destination')\n      .reduce((acc, plugin) => {\n        const name = `${plugin.name\n          .toLowerCase()\n          .replace('.', '')\n          .split(' ')\n          .join('-')}Integration`\n\n        // @ts-expect-error\n        const integration = window[name] as\n          | (LegacyIntegration & { Integration?: LegacyIntegration })\n          | undefined\n\n        if (!integration) {\n          return acc\n        }\n\n        const nested = integration.Integration // hack - Google Analytics function resides in the \"Integration\" field\n        if (nested) {\n          acc[plugin.name] = nested\n          return acc\n        }\n\n        acc[plugin.name] = integration as LegacyIntegration\n        return acc\n      }, {} as Record<string, LegacyIntegration>)\n\n    return integrations\n  }\n\n  log = _stub\n  addIntegrationMiddleware = _stub\n  listeners = _stub\n  addEventListener = _stub\n  removeAllListeners = _stub\n  removeListener = _stub\n  removeEventListener = _stub\n  hasListeners = _stub\n  add = _stub\n  addIntegration = _stub\n\n  // snippet function\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  push(args: any[]) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const an = this as any\n    const method = args.shift()\n    if (method) {\n      if (!an[method]) return\n    }\n    an[method].apply(this, args)\n  }\n}\n", "/**\n * Returns `process.env` if it is available in the environment.\n * Always returns an object make it similarly easy to use as `process.env`.\n */\nexport function getProcessEnv(): { [key: string]: string | undefined } {\n  if (typeof process === 'undefined' || !process.env) {\n    return {}\n  }\n\n  return process.env\n}\n", "/**\n * Return a promise that can be externally resolved\n */\nexport const createDeferred = <T>() => {\n  let resolve!: (value: T | PromiseLike<T>) => void\n  let reject!: (reason: any) => void\n  const promise = new Promise<T>((_resolve, _reject) => {\n    resolve = _resolve\n    reject = _reject\n  })\n  return {\n    resolve,\n    reject,\n    promise,\n  }\n}\n", "/**\n * @example\n * pick({ 'a': 1, 'b': '2', 'c': 3 }, ['a', 'c'])\n * => { 'a': 1, 'c': 3 }\n */\nexport const pick = <T, K extends keyof T>(\n  object: T,\n  keys: readonly K[]\n): Pick<T, K> =>\n  Object.assign(\n    {},\n    ...keys.map((key) => {\n      if (object && Object.prototype.hasOwnProperty.call(object, key)) {\n        return { [key]: object[key] }\n      }\n    })\n  )\n", "import { pick } from '../../lib/pick'\nimport type { Context } from '../../core/context'\nimport type { Plugin } from '../../core/plugin'\n\ninterface PageDefault {\n  [key: string]: unknown\n  path: string\n  referrer: string\n  search: string\n  title: string\n  url: string\n}\n\n/**\n * Get the current page's canonical URL.\n */\nfunction canonical(): string | undefined {\n  const canon = document.querySelector(\"link[rel='canonical']\")\n  if (canon) {\n    return canon.getAttribute('href') || undefined\n  }\n}\n\n/**\n * Return the canonical path for the page.\n */\n\nfunction canonicalPath(): string {\n  const canon = canonical()\n  if (!canon) {\n    return window.location.pathname\n  }\n\n  const a = document.createElement('a')\n  a.href = canon\n  const pathname = !a.pathname.startsWith('/') ? '/' + a.pathname : a.pathname\n\n  return pathname\n}\n\n/**\n * Return the canonical URL for the page concat the given `search`\n * and strip the hash.\n */\n\nexport function canonicalUrl(search = ''): string {\n  const canon = canonical()\n  if (canon) {\n    return canon.includes('?') ? canon : `${canon}${search}`\n  }\n  const url = window.location.href\n  const i = url.indexOf('#')\n  return i === -1 ? url : url.slice(0, i)\n}\n\n/**\n * Return a default `options.context.page` object.\n *\n * https://segment.com/docs/spec/page/#properties\n */\n\nexport function pageDefaults(): PageDefault {\n  return {\n    path: canonicalPath(),\n    referrer: document.referrer,\n    search: location.search,\n    title: document.title,\n    url: canonicalUrl(location.search),\n  }\n}\n\nfunction enrichPageContext(ctx: Context): Context {\n  const event = ctx.event\n  event.context = event.context || {}\n\n  const defaultPageContext = pageDefaults()\n\n  const pageContextFromEventProps =\n    event.properties && pick(event.properties, Object.keys(defaultPageContext))\n\n  event.context.page = {\n    ...defaultPageContext,\n    ...pageContextFromEventProps,\n    ...event.context.page,\n  }\n\n  if (event.type === 'page') {\n    event.properties = {\n      ...defaultPageContext,\n      ...event.properties,\n      ...(event.name ? { name: event.name } : {}),\n    }\n  }\n\n  return ctx\n}\n\nexport const pageEnrichment: Plugin = {\n  name: 'Page Enrichment',\n  version: '0.1.0',\n  isLoaded: () => true,\n  load: () => Promise.resolve(),\n  type: 'before',\n  page: enrichPageContext,\n  alias: enrichPageContext,\n  track: enrichPageContext,\n  identify: enrichPageContext,\n  group: enrichPageContext,\n}\n", "import type { Integrations } from '../../core/events/interfaces'\nimport { LegacySettings } from '../../browser'\nimport { JSONObject, JSONValue } from '../../core/events'\nimport { DestinationPlugin, Plugin } from '../../core/plugin'\nimport { loadScript } from '../../lib/load-script'\nimport { getCDN } from '../../lib/parse-cdn'\nimport {\n  applyDestinationMiddleware,\n  DestinationMiddlewareFunction,\n} from '../middleware'\nimport { Context, ContextCancelation } from '../../core/context'\nimport { Analytics } from '../../core/analytics'\n\nexport interface RemotePlugin {\n  /** The name of the remote plugin */\n  name: string\n  /** The creation name of the remote plugin */\n  creationName: string\n  /** The url of the javascript file to load */\n  url: string\n  /** The UMD/global name the plugin uses. Plugins are expected to exist here with the `PluginFactory` method signature */\n  libraryName: string\n  /** The settings related to this plugin. */\n  settings: JSONObject\n}\n\nexport class ActionDestination implements DestinationPlugin {\n  name: string // destination name\n  version = '1.0.0'\n  type: Plugin['type']\n\n  alternativeNames: string[] = []\n\n  middleware: DestinationMiddlewareFunction[] = []\n\n  action: Plugin\n\n  constructor(name: string, action: Plugin) {\n    this.action = action\n    this.name = name\n    this.type = action.type\n    this.alternativeNames.push(action.name)\n  }\n\n  addMiddleware(...fn: DestinationMiddlewareFunction[]): void {\n    if (this.type === 'destination') {\n      this.middleware.push(...fn)\n    }\n  }\n\n  private async transform(ctx: Context): Promise<Context> {\n    const modifiedEvent = await applyDestinationMiddleware(\n      this.name,\n      ctx.event,\n      this.middleware\n    )\n\n    if (modifiedEvent === null) {\n      ctx.cancel(\n        new ContextCancelation({\n          retry: false,\n          reason: 'dropped by destination middleware',\n        })\n      )\n    }\n\n    return new Context(modifiedEvent!)\n  }\n\n  private _createMethod(\n    methodName: 'track' | 'page' | 'identify' | 'alias' | 'group' | 'screen'\n  ) {\n    return async (ctx: Context): Promise<Context> => {\n      if (!this.action[methodName]) return ctx\n\n      let transformedContext: Context = ctx\n      // Transformations only allowed for destination plugins. Other plugin types support mutating events.\n      if (this.type === 'destination') {\n        transformedContext = await this.transform(ctx)\n      }\n\n      await this.action[methodName]!(transformedContext)\n\n      return ctx\n    }\n  }\n\n  alias = this._createMethod('alias')\n  group = this._createMethod('group')\n  identify = this._createMethod('identify')\n  page = this._createMethod('page')\n  screen = this._createMethod('screen')\n  track = this._createMethod('track')\n\n  /* --- PASSTHROUGH METHODS --- */\n  isLoaded(): boolean {\n    return this.action.isLoaded()\n  }\n\n  ready(): Promise<unknown> {\n    return this.action.ready ? this.action.ready() : Promise.resolve()\n  }\n\n  load(ctx: Context, analytics: Analytics): Promise<unknown> {\n    return this.action.load(ctx, analytics)\n  }\n\n  unload(ctx: Context, analytics: Analytics): Promise<unknown> | unknown {\n    return this.action.unload?.(ctx, analytics)\n  }\n}\n\ntype PluginFactory = (\n  settings: JSONValue\n) => Plugin | Plugin[] | Promise<Plugin | Plugin[]>\n\nfunction validate(pluginLike: unknown): pluginLike is Plugin[] {\n  if (!Array.isArray(pluginLike)) {\n    throw new Error('Not a valid list of plugins')\n  }\n\n  const required = ['load', 'isLoaded', 'name', 'version', 'type']\n  pluginLike.forEach((plugin) => {\n    required.forEach((method) => {\n      if (plugin[method] === undefined) {\n        throw new Error(\n          `Plugin: ${\n            plugin.name ?? 'unknown'\n          } missing required function ${method}`\n        )\n      }\n    })\n  })\n\n  return true\n}\n\nfunction isPluginDisabled(\n  userIntegrations: Integrations,\n  remotePlugin: RemotePlugin\n) {\n  const creationNameEnabled = userIntegrations[remotePlugin.creationName]\n  const currentNameEnabled = userIntegrations[remotePlugin.name]\n\n  // Check that the plugin isn't explicitly enabled when All: false\n  if (\n    userIntegrations.All === false &&\n    !creationNameEnabled &&\n    !currentNameEnabled\n  ) {\n    return true\n  }\n\n  // Check that the plugin isn't explicitly disabled\n  if (creationNameEnabled === false || currentNameEnabled === false) {\n    return true\n  }\n\n  return false\n}\n\nexport async function remoteLoader(\n  settings: LegacySettings,\n  userIntegrations: Integrations,\n  mergedIntegrations: Record<string, JSONObject>,\n  obfuscate?: boolean,\n  routingMiddleware?: DestinationMiddlewareFunction\n): Promise<Plugin[]> {\n  const allPlugins: Plugin[] = []\n  const cdn = getCDN()\n\n  const routingRules = settings.middlewareSettings?.routingRules ?? []\n\n  const pluginPromises = (settings.remotePlugins ?? []).map(\n    async (remotePlugin) => {\n      if (isPluginDisabled(userIntegrations, remotePlugin)) return\n      try {\n        const defaultCdn = new RegExp('https://cdn.segment.(com|build)')\n        if (obfuscate) {\n          const urlSplit = remotePlugin.url.split('/')\n          const name = urlSplit[urlSplit.length - 2]\n          const obfuscatedURL = remotePlugin.url.replace(\n            name,\n            btoa(name).replace(/=/g, '')\n          )\n          try {\n            await loadScript(obfuscatedURL.replace(defaultCdn, cdn))\n          } catch (error) {\n            // Due to syncing concerns it is possible that the obfuscated action destination (or requested version) might not exist.\n            // We should use the unobfuscated version as a fallback.\n            await loadScript(remotePlugin.url.replace(defaultCdn, cdn))\n          }\n        } else {\n          await loadScript(remotePlugin.url.replace(defaultCdn, cdn))\n        }\n\n        const libraryName = remotePlugin.libraryName\n\n        // @ts-expect-error\n        if (typeof window[libraryName] === 'function') {\n          // @ts-expect-error\n          const pluginFactory = window[libraryName] as PluginFactory\n          const plugin = await pluginFactory({\n            ...remotePlugin.settings,\n            ...mergedIntegrations[remotePlugin.name],\n          })\n          const plugins = Array.isArray(plugin) ? plugin : [plugin]\n\n          validate(plugins)\n\n          const routing = routingRules.filter(\n            (rule) => rule.destinationName === remotePlugin.creationName\n          )\n\n          plugins.forEach((plugin) => {\n            const wrapper = new ActionDestination(\n              remotePlugin.creationName,\n              plugin\n            )\n\n            /** Make sure we only apply destination filters to actions of the \"destination\" type to avoid causing issues for hybrid destinations */\n            if (\n              routing.length &&\n              routingMiddleware &&\n              plugin.type === 'destination'\n            ) {\n              wrapper.addMiddleware(routingMiddleware)\n            }\n\n            allPlugins.push(wrapper)\n          })\n        }\n      } catch (error) {\n        console.warn('Failed to load Remote Plugin', error)\n      }\n    }\n  )\n\n  await Promise.all(pluginPromises)\n  return allPlugins.filter(Boolean)\n}\n", "/**\n * Register event listener on document that fires when:\n * * tab change or tab close (in mobile or desktop)\n * * click back / forward button\n * * click any link or perform any other navigation action\n * * soft refresh / hard refresh\n *\n * adapted from https://stackoverflow.com/questions/3239834/window-onbeforeunload-not-working-on-the-ipad/52864508#52864508,\n */\nexport const onPageLeave = (cb: (...args: unknown[]) => void) => {\n  let unloaded = false // prevents double firing if both are supported\n\n  window.addEventListener('pagehide', () => {\n    if (unloaded) return\n    unloaded = true\n    cb()\n  })\n\n  // using document instead of window because of bug affecting browsers before safari 14 (detail in footnotes https://caniuse.com/?search=visibilitychange)\n  document.addEventListener('visibilitychange', () => {\n    if (document.visibilityState == 'hidden') {\n      if (unloaded) return\n      unloaded = true\n      cb()\n    } else {\n      unloaded = false\n    }\n  })\n}\n", "import { SegmentEvent } from '../../core/events'\nimport { fetch } from '../../lib/fetch'\nimport { onPageLeave } from '../../lib/on-page-leave'\n\nexport type BatchingDispatchConfig = {\n  size?: number\n  timeout?: number\n}\n\nconst MAX_PAYLOAD_SIZE = 500\n\nfunction kilobytes(buffer: unknown): number {\n  const size = encodeURI(JSON.stringify(buffer)).split(/%..|./).length - 1\n  return size / 1024\n}\n\n/**\n * Checks if the payload is over or close to\n * the maximum payload size allowed by tracking\n * API.\n */\nfunction approachingTrackingAPILimit(buffer: unknown): boolean {\n  return kilobytes(buffer) >= MAX_PAYLOAD_SIZE - 50\n}\n\nfunction chunks(batch: object[]): Array<object[]> {\n  const result: object[][] = []\n  let index = 0\n\n  batch.forEach((item) => {\n    const size = kilobytes(result[index])\n    if (size >= 64) {\n      index++\n    }\n\n    if (result[index]) {\n      result[index].push(item)\n    } else {\n      result[index] = [item]\n    }\n  })\n\n  return result\n}\n\nexport default function batch(\n  apiHost: string,\n  config?: BatchingDispatchConfig\n) {\n  let buffer: object[] = []\n  let pageUnloaded = false\n\n  const limit = config?.size ?? 10\n  const timeout = config?.timeout ?? 5000\n\n  function sendBatch(batch: object[]) {\n    if (batch.length === 0) {\n      return\n    }\n\n    const writeKey = (batch[0] as SegmentEvent)?.writeKey\n\n    return fetch(`https://${apiHost}/b`, {\n      keepalive: pageUnloaded,\n      headers: {\n        'Content-Type': 'text/plain',\n      },\n      method: 'post',\n      body: JSON.stringify({ batch, writeKey }),\n    })\n  }\n\n  async function flush(): Promise<unknown> {\n    if (buffer.length) {\n      const batch = buffer\n      buffer = []\n      return sendBatch(batch)\n    }\n  }\n\n  let schedule: NodeJS.Timeout | undefined\n\n  function scheduleFlush(): void {\n    if (schedule) {\n      return\n    }\n\n    schedule = setTimeout(() => {\n      schedule = undefined\n      flush().catch(console.error)\n    }, timeout)\n  }\n\n  onPageLeave(() => {\n    pageUnloaded = true\n\n    if (buffer.length) {\n      const reqs = chunks(buffer).map(sendBatch)\n      Promise.all(reqs).catch(console.error)\n    }\n  })\n\n  async function dispatch(_url: string, body: object): Promise<unknown> {\n    buffer.push(body)\n\n    const bufferOverflow =\n      buffer.length >= limit || approachingTrackingAPILimit(buffer)\n\n    return bufferOverflow || pageUnloaded ? flush() : scheduleFlush()\n  }\n\n  return {\n    dispatch,\n  }\n}\n", "import { fetch } from '../../lib/fetch'\n\nexport type Dispatcher = (url: string, body: object) => Promise<unknown>\n\nexport type StandardDispatcherConfig = {\n  keepalive?: boolean\n}\n\nexport default function (config?: StandardDispatcherConfig): {\n  dispatch: Dispatcher\n} {\n  function dispatch(url: string, body: object): Promise<unknown> {\n    return fetch(url, {\n      keepalive: config?.keepalive,\n      headers: { 'Content-Type': 'text/plain' },\n      method: 'post',\n      body: JSON.stringify(body),\n    })\n  }\n\n  return {\n    dispatch,\n  }\n}\n", "import { isOffline } from '../../core/connection'\nimport { Context } from '../../core/context'\nimport { Plugin } from '../../core/plugin'\nimport { attempt } from '@segment/analytics-core'\nimport { pWhile } from '../../lib/p-while'\nimport { PriorityQueue } from '../../lib/priority-queue'\n\nasync function flushQueue(\n  xt: Plugin,\n  queue: PriorityQueue<Context>\n): Promise<PriorityQueue<Context>> {\n  const failedQueue: Context[] = []\n  if (isOffline()) {\n    return queue\n  }\n\n  await pWhile(\n    () => queue.length > 0 && !isOffline(),\n    async () => {\n      const ctx = queue.pop()\n      if (!ctx) {\n        return\n      }\n\n      const result = await attempt(ctx, xt)\n      const success = result instanceof Context\n      if (!success) {\n        failedQueue.push(ctx)\n      }\n    }\n  )\n  // re-add failed tasks\n  failedQueue.map((failed) => queue.pushWithBackoff(failed))\n  return queue\n}\n\nexport function scheduleFlush(\n  flushing: boolean,\n  buffer: PriorityQueue<Context>,\n  xt: Plugin,\n  scheduleFlush: Function\n): void {\n  if (flushing) {\n    return\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-misused-promises\n  setTimeout(async () => {\n    let isFlushing = true\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    const newBuffer = await flushQueue(xt, buffer)\n    isFlushing = false\n\n    if (buffer.todo > 0) {\n      scheduleFlush(isFlushing, newBuffer, xt, scheduleFlush)\n    }\n  }, Math.random() * 5000)\n}\n", "import { Facade } from '@segment/facade'\nimport { Analytics } from '../../core/analytics'\nimport { LegacySettings } from '../../browser'\nimport { isOffline } from '../../core/connection'\nimport { Context } from '../../core/context'\nimport { Plugin } from '../../core/plugin'\nimport { PriorityQueue } from '../../lib/priority-queue'\nimport { PersistedPriorityQueue } from '../../lib/priority-queue/persisted'\nimport { toFacade } from '../../lib/to-facade'\nimport batch, { BatchingDispatchConfig } from './batched-dispatcher'\nimport standard, { StandardDispatcherConfig } from './fetch-dispatcher'\nimport { normalize } from './normalize'\nimport { scheduleFlush } from './schedule-flush'\nimport { SEGMENT_API_HOST } from '../../core/constants'\n\ntype DeliveryStrategy =\n  | {\n      strategy?: 'standard'\n      config?: StandardDispatcherConfig\n    }\n  | {\n      strategy?: 'batching'\n      config?: BatchingDispatchConfig\n    }\n\nexport type SegmentioSettings = {\n  apiKey: string\n  apiHost?: string\n  protocol?: 'http' | 'https'\n\n  addBundledMetadata?: boolean\n  unbundledIntegrations?: string[]\n  bundledConfigIds?: string[]\n  unbundledConfigIds?: string[]\n\n  maybeBundledConfigIds?: Record<string, string[]>\n\n  deliveryStrategy?: DeliveryStrategy\n}\n\ntype JSON = ReturnType<Facade['json']>\n\nfunction onAlias(analytics: Analytics, json: JSON): JSON {\n  const user = analytics.user()\n  json.previousId =\n    json.previousId ?? json.from ?? user.id() ?? user.anonymousId()\n  json.userId = json.userId ?? json.to\n  delete json.from\n  delete json.to\n  return json\n}\n\nexport function segmentio(\n  analytics: Analytics,\n  settings?: SegmentioSettings,\n  integrations?: LegacySettings['integrations']\n): Plugin {\n  // Attach `pagehide` before buffer is created so that inflight events are added\n  // to the buffer before the buffer persists events in its own `pagehide` handler.\n  window.addEventListener('pagehide', () => {\n    buffer.push(...Array.from(inflightEvents))\n    inflightEvents.clear()\n  })\n\n  const buffer = analytics.options.disableClientPersistence\n    ? new PriorityQueue<Context>(analytics.queue.queue.maxAttempts, [])\n    : new PersistedPriorityQueue(\n        analytics.queue.queue.maxAttempts,\n        `dest-Segment.io`\n      )\n\n  const inflightEvents = new Set<Context>()\n  const flushing = false\n\n  const apiHost = settings?.apiHost ?? SEGMENT_API_HOST\n  const protocol = settings?.protocol ?? 'https'\n  const remote = `${protocol}://${apiHost}`\n\n  const deliveryStrategy = settings?.deliveryStrategy\n  const client =\n    deliveryStrategy?.strategy === 'batching'\n      ? batch(apiHost, deliveryStrategy.config)\n      : standard(deliveryStrategy?.config as StandardDispatcherConfig)\n\n  async function send(ctx: Context): Promise<Context> {\n    if (isOffline()) {\n      buffer.push(ctx)\n      // eslint-disable-next-line @typescript-eslint/no-use-before-define\n      scheduleFlush(flushing, buffer, segmentio, scheduleFlush)\n      return ctx\n    }\n\n    inflightEvents.add(ctx)\n\n    const path = ctx.event.type.charAt(0)\n    let json = toFacade(ctx.event).json()\n\n    if (ctx.event.type === 'track') {\n      delete json.traits\n    }\n\n    if (ctx.event.type === 'alias') {\n      json = onAlias(analytics, json)\n    }\n\n    return client\n      .dispatch(\n        `${remote}/${path}`,\n        normalize(analytics, json, settings, integrations)\n      )\n      .then(() => ctx)\n      .catch(() => {\n        buffer.pushWithBackoff(ctx)\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        scheduleFlush(flushing, buffer, segmentio, scheduleFlush)\n        return ctx\n      })\n      .finally(() => {\n        inflightEvents.delete(ctx)\n      })\n  }\n\n  const segmentio: Plugin = {\n    name: 'Segment.io',\n    type: 'after',\n    version: '0.1.0',\n    isLoaded: (): boolean => true,\n    load: (): Promise<void> => Promise.resolve(),\n    track: send,\n    identify: send,\n    page: send,\n    alias: send,\n    group: send,\n  }\n\n  // Buffer may already have items if they were previously stored in localStorage.\n  // Start flushing them immediately.\n  if (buffer.todo) {\n    scheduleFlush(flushing, buffer, segmentio, scheduleFlush)\n  }\n\n  return segmentio\n}\n", "import type { Plugin } from '../../core/plugin'\nimport type { Context } from '../../core/context'\nimport {\n  assertUserIdentity,\n  isPlainObject,\n  ValidationError,\n  assertEventExists,\n  assertEventType,\n  assertTrackEventName,\n} from '@segment/analytics-core'\n\nfunction validate(ctx: Context): Context {\n  const event = ctx.event\n  assertEventExists(event)\n  assertEventType(event)\n\n  if (event.type === 'track') {\n    assertTrackEventName(event)\n  }\n\n  const props = event.properties ?? event.traits\n  if (event.type !== 'alias' && !isPlainObject(props)) {\n    throw new ValidationError('.properties', 'is not an object')\n  }\n\n  assertUserIdentity(event)\n  return ctx\n}\n\nexport const validation: Plugin = {\n  name: 'Event Validation',\n  type: 'before',\n  version: '1.0.0',\n\n  isLoaded: () => true,\n  load: () => Promise.resolve(),\n\n  track: validate,\n  identify: validate,\n  page: validate,\n  alias: validate,\n  group: validate,\n  screen: validate,\n}\n", "/**\n *  Check if  thenable\n *  (instanceof Promise doesn't respect realms)\n */\nexport const isThenable = (value: unknown): boolean =>\n  typeof value === 'object' &&\n  value !== null &&\n  'then' in value &&\n  typeof (value as any).then === 'function'\n", "import { Analytics } from '../analytics'\nimport { Context } from '../context'\nimport { isThenable } from '../../lib/is-thenable'\nimport { AnalyticsBrowserCore } from '../analytics/interfaces'\nimport { version } from '../../generated/version'\n\n/**\n * The names of any AnalyticsBrowser methods that also exist on Analytics\n */\nexport type PreInitMethodName =\n  | 'screen'\n  | 'register'\n  | 'deregister'\n  | 'user'\n  | 'trackSubmit'\n  | 'trackClick'\n  | 'trackLink'\n  | 'trackForm'\n  | 'pageview'\n  | 'identify'\n  | 'reset'\n  | 'group'\n  | 'track'\n  | 'ready'\n  | 'alias'\n  | 'debug'\n  | 'page'\n  | 'once'\n  | 'off'\n  | 'on'\n  | 'addSourceMiddleware'\n  | 'setAnonymousId'\n  | 'addDestinationMiddleware'\n\n// Union of all analytics methods that _do not_ return a Promise\ntype SyncPreInitMethodName = {\n  [MethodName in PreInitMethodName]: ReturnType<\n    Analytics[MethodName]\n  > extends Promise<any>\n    ? never\n    : MethodName\n}[PreInitMethodName]\n\nconst flushSyncAnalyticsCalls = (\n  name: SyncPreInitMethodName,\n  analytics: Analytics,\n  buffer: PreInitMethodCallBuffer\n): void => {\n  buffer.getCalls(name).forEach((c) => {\n    // While the underlying methods are synchronous, the callAnalyticsMethod returns a promise,\n    // which normalizes success and error states between async and non-async methods, with no perf penalty.\n    callAnalyticsMethod(analytics, c).catch(console.error)\n  })\n}\n\nexport const flushAddSourceMiddleware = async (\n  analytics: Analytics,\n  buffer: PreInitMethodCallBuffer\n) => {\n  for (const c of buffer.getCalls('addSourceMiddleware')) {\n    await callAnalyticsMethod(analytics, c).catch(console.error)\n  }\n}\n\nexport const flushOn = flushSyncAnalyticsCalls.bind(this, 'on')\n\nexport const flushSetAnonymousID = flushSyncAnalyticsCalls.bind(\n  this,\n  'setAnonymousId'\n)\n\nexport const flushAnalyticsCallsInNewTask = (\n  analytics: Analytics,\n  buffer: PreInitMethodCallBuffer\n): void => {\n  buffer.toArray().forEach((m) => {\n    setTimeout(() => {\n      callAnalyticsMethod(analytics, m).catch(console.error)\n    }, 0)\n  })\n}\n\n/**\n *  Represents a buffered method call that occurred before initialization.\n */\nexport interface PreInitMethodCall<\n  MethodName extends PreInitMethodName = PreInitMethodName\n> {\n  method: MethodName\n  args: PreInitMethodParams<MethodName>\n  called: boolean\n  resolve: (v: ReturnType<Analytics[MethodName]>) => void\n  reject: (reason: any) => void\n}\n\nexport type PreInitMethodParams<MethodName extends PreInitMethodName> =\n  Parameters<Analytics[MethodName]>\n\n/**\n * Infer return type; if return type is promise, unwrap it.\n */\ntype ReturnTypeUnwrap<Fn> = Fn extends (...args: any[]) => infer ReturnT\n  ? ReturnT extends PromiseLike<infer Unwrapped>\n    ? Unwrapped\n    : ReturnT\n  : never\n\ntype MethodCallMap = Partial<Record<PreInitMethodName, PreInitMethodCall[]>>\n\n/**\n *  Represents any and all the buffered method calls that occurred before initialization.\n */\nexport class PreInitMethodCallBuffer {\n  private _value = {} as MethodCallMap\n\n  toArray(): PreInitMethodCall[] {\n    return ([] as PreInitMethodCall[]).concat(...Object.values(this._value))\n  }\n\n  getCalls<T extends PreInitMethodName>(methodName: T): PreInitMethodCall<T>[] {\n    return (this._value[methodName] ?? []) as PreInitMethodCall<T>[]\n  }\n\n  push(...calls: PreInitMethodCall[]): PreInitMethodCallBuffer {\n    calls.forEach((call) => {\n      if (this._value[call.method]) {\n        this._value[call.method]!.push(call)\n      } else {\n        this._value[call.method] = [call]\n      }\n    })\n    return this\n  }\n\n  clear(): PreInitMethodCallBuffer {\n    this._value = {} as MethodCallMap\n    return this\n  }\n}\n\n/**\n *  Call method and mark as \"called\"\n *  This function should never throw an error\n */\nexport async function callAnalyticsMethod<T extends PreInitMethodName>(\n  analytics: Analytics,\n  call: PreInitMethodCall<T>\n): Promise<void> {\n  try {\n    if (call.called) {\n      return undefined\n    }\n    call.called = true\n\n    const result: ReturnType<Analytics[T]> = (\n      analytics[call.method] as Function\n    )(...call.args)\n\n    if (isThenable(result)) {\n      // do not defer for non-async methods\n      await result\n    }\n\n    call.resolve(result)\n  } catch (err) {\n    call.reject(err)\n  }\n}\n\nexport type AnalyticsLoader = (\n  preInitBuffer: PreInitMethodCallBuffer\n) => Promise<[Analytics, Context]>\n\nexport class AnalyticsBuffered\n  implements PromiseLike<[Analytics, Context]>, AnalyticsBrowserCore\n{\n  instance?: Analytics\n  ctx?: Context\n  private _preInitBuffer = new PreInitMethodCallBuffer()\n  private _promise: Promise<[Analytics, Context]>\n  constructor(loader: AnalyticsLoader) {\n    this._promise = loader(this._preInitBuffer)\n    this._promise\n      .then(([ajs, ctx]) => {\n        this.instance = ajs\n        this.ctx = ctx\n      })\n      .catch(() => {\n        // intentionally do nothing...\n        // this result of this promise will be caught by the 'catch' block on this class.\n      })\n  }\n\n  then<T1, T2 = never>(\n    ...args: [\n      onfulfilled:\n        | ((instance: [Analytics, Context]) => T1 | PromiseLike<T1>)\n        | null\n        | undefined,\n      onrejected?: (reason: unknown) => T2 | PromiseLike<T2>\n    ]\n  ) {\n    return this._promise.then(...args)\n  }\n\n  catch<TResult = never>(\n    ...args: [\n      onrejected?:\n        | ((reason: any) => TResult | PromiseLike<TResult>)\n        | undefined\n        | null\n    ]\n  ) {\n    return this._promise.catch(...args)\n  }\n\n  finally(...args: [onfinally?: (() => void) | undefined | null]) {\n    return this._promise.finally(...args)\n  }\n\n  trackSubmit = this._createMethod('trackSubmit')\n  trackClick = this._createMethod('trackClick')\n  trackLink = this._createMethod('trackLink')\n  pageView = this._createMethod('pageview')\n  identify = this._createMethod('identify')\n  reset = this._createMethod('reset')\n  group = this._createMethod('group') as AnalyticsBrowserCore['group']\n  track = this._createMethod('track')\n  ready = this._createMethod('ready')\n  alias = this._createMethod('alias')\n  debug = this._createChainableMethod('debug')\n  page = this._createMethod('page')\n  once = this._createChainableMethod('once')\n  off = this._createChainableMethod('off')\n  on = this._createChainableMethod('on')\n  addSourceMiddleware = this._createMethod('addSourceMiddleware')\n  setAnonymousId = this._createMethod('setAnonymousId')\n  addDestinationMiddleware = this._createMethod('addDestinationMiddleware')\n\n  screen = this._createMethod('screen')\n  register = this._createMethod('register')\n  deregister = this._createMethod('deregister')\n  user = this._createMethod('user')\n  readonly VERSION = version\n\n  private _createMethod<T extends PreInitMethodName>(methodName: T) {\n    return (\n      ...args: Parameters<Analytics[T]>\n    ): Promise<ReturnTypeUnwrap<Analytics[T]>> => {\n      if (this.instance) {\n        const result = (this.instance[methodName] as Function)(...args)\n        return Promise.resolve(result)\n      }\n\n      return new Promise((resolve, reject) => {\n        this._preInitBuffer.push({\n          method: methodName,\n          args,\n          resolve: resolve,\n          reject: reject,\n          called: false,\n        } as PreInitMethodCall)\n      })\n    }\n  }\n\n  /**\n   *  These are for methods that where determining when the method gets \"flushed\" is not important.\n   *  These methods will resolve when analytics is fully initialized, and return type (other than Analytics)will not be available.\n   */\n  private _createChainableMethod<T extends PreInitMethodName>(methodName: T) {\n    return (...args: Parameters<Analytics[T]>): AnalyticsBuffered => {\n      if (this.instance) {\n        void (this.instance[methodName] as Function)(...args)\n        return this\n      } else {\n        this._preInitBuffer.push({\n          method: methodName,\n          args,\n          resolve: () => {},\n          reject: console.error,\n          called: false,\n        } as PreInitMethodCall)\n      }\n\n      return this\n    }\n  }\n}\n", "import type {\n  PreInitMethodCall,\n  PreInitMethodName,\n  PreInitMethodParams,\n} from '.'\n\nexport function transformSnippetCall([\n  methodName,\n  ...args\n]: SnippetWindowBufferedMethodCall): PreInitMethodCall {\n  return {\n    method: methodName,\n    resolve: () => {},\n    reject: console.error,\n    args,\n    called: false,\n  }\n}\n\nconst normalizeSnippetBuffer = (buffer: SnippetBuffer): PreInitMethodCall[] => {\n  return buffer.map(transformSnippetCall)\n}\n\ntype SnippetWindowBufferedMethodCall<\n  MethodName extends PreInitMethodName = PreInitMethodName\n> = [MethodName, ...PreInitMethodParams<MethodName>]\n\n/**\n * A list of the method calls before initialization for snippet users\n * For example, [[\"track\", \"foo\", {bar: 123}], [\"page\"], [\"on\", \"ready\", function(){..}]\n */\ntype SnippetBuffer = SnippetWindowBufferedMethodCall[]\n\n/**\n * Fetch the buffered method calls from the window object and normalize them.\n * This removes existing buffered calls from the window object.\n */\nexport const popSnippetWindowBuffer = (): PreInitMethodCall[] => {\n  const wa = window.analytics\n  if (!Array.isArray(wa)) return []\n  const buffered = wa.splice(0, wa.length)\n  return normalizeSnippetBuffer(buffered)\n}\n", "import { getGlobal } from '../../lib/get-global'\nimport type { Analytics } from '../analytics'\n\nconst env = getGlobal()\n\n// The code below assumes the inspector extension will use Object.assign\n// to add the inspect interface on to this object reference (unless the\n// extension code ran first and has already set up the variable)\nconst inspectorHost: {\n  attach: (analytics: Analytics) => void\n} = ((env as any)['__SEGMENT_INSPECTOR__'] ??= {})\n\nexport const attachInspector = (analytics: Analytics) =>\n  inspectorHost.attach?.(analytics as any)\n", "import { getProcessEnv } from '../lib/get-process-env'\nimport { getCDN, setGlobalCDNUrl } from '../lib/parse-cdn'\n\nimport { fetch } from '../lib/fetch'\nimport { Analytics, AnalyticsSettings, InitOptions } from '../core/analytics'\nimport { Context } from '../core/context'\nimport { Plan } from '../core/events'\nimport { Plugin } from '../core/plugin'\nimport { MetricsOptions } from '../core/stats/remote-metrics'\nimport { mergedOptions } from '../lib/merged-options'\nimport { createDeferred } from '../lib/create-deferred'\nimport { pageEnrichment } from '../plugins/page-enrichment'\nimport { remoteLoader, RemotePlugin } from '../plugins/remote-loader'\nimport type { RoutingRule } from '../plugins/routing-middleware'\nimport { segmentio, SegmentioSettings } from '../plugins/segmentio'\nimport { validation } from '../plugins/validation'\nimport {\n  AnalyticsBuffered,\n  PreInitMethodCallBuffer,\n  flushAnalyticsCallsInNewTask,\n  flushAddSourceMiddleware,\n  flushSetAnonymousID,\n  flushOn,\n} from '../core/buffer'\nimport { popSnippetWindowBuffer } from '../core/buffer/snippet'\nimport { ClassicIntegrationSource } from '../plugins/ajs-destination/types'\nimport { attachInspector } from '../core/inspector'\nimport { Stats } from '../core/stats'\n\nexport interface LegacyIntegrationConfiguration {\n  /* @deprecated - This does not indicate browser types anymore */\n  type?: string\n\n  versionSettings?: {\n    version?: string\n    override?: string\n    componentTypes?: Array<'browser' | 'android' | 'ios' | 'server'>\n  }\n\n  bundlingStatus?: string\n\n  // Segment.io specific\n  retryQueue?: boolean\n\n  // any extra unknown settings\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any\n}\n\nexport interface LegacySettings {\n  integrations: {\n    [name: string]: LegacyIntegrationConfiguration\n  }\n\n  middlewareSettings?: {\n    routingRules: RoutingRule[]\n  }\n\n  enabledMiddleware?: Record<string, boolean>\n  metrics?: MetricsOptions\n\n  plan?: Plan\n\n  legacyVideoPluginsEnabled?: boolean\n\n  remotePlugins?: RemotePlugin[]\n}\n\nexport interface AnalyticsBrowserSettings extends AnalyticsSettings {\n  /**\n   * The settings for the Segment Source.\n   * If provided, `AnalyticsBrowser` will not fetch remote settings\n   * for the source.\n   */\n  cdnSettings?: LegacySettings & Record<string, unknown>\n  /**\n   * If provided, will override the default Segment CDN (https://cdn.segment.com) for this application.\n   */\n  cdnURL?: string\n}\n\nexport function loadLegacySettings(\n  writeKey: string,\n  cdnURL?: string\n): Promise<LegacySettings> {\n  const baseUrl = cdnURL ?? getCDN()\n\n  return fetch(`${baseUrl}/v1/projects/${writeKey}/settings`)\n    .then((res) => {\n      if (!res.ok) {\n        return res.text().then((errorResponseMessage) => {\n          throw new Error(errorResponseMessage)\n        })\n      }\n      return res.json()\n    })\n    .catch((err) => {\n      console.error(err.message)\n      throw err\n    })\n}\n\nfunction hasLegacyDestinations(settings: LegacySettings): boolean {\n  return (\n    getProcessEnv().NODE_ENV !== 'test' &&\n    // just one integration means segmentio\n    Object.keys(settings.integrations).length > 1\n  )\n}\n\nfunction hasTsubMiddleware(settings: LegacySettings): boolean {\n  return (\n    getProcessEnv().NODE_ENV !== 'test' &&\n    (settings.middlewareSettings?.routingRules?.length ?? 0) > 0\n  )\n}\n\n/**\n * With AJS classic, we allow users to call setAnonymousId before the library initialization.\n * This is important because some of the destinations will use the anonymousId during the initialization,\n * and if we set anonId afterwards, that wouldnt impact the destination.\n *\n * Also Ensures events can be registered before library initialization.\n * This is important so users can register to 'initialize' and any events that may fire early during setup.\n */\nfunction flushPreBuffer(\n  analytics: Analytics,\n  buffer: PreInitMethodCallBuffer\n): void {\n  buffer.push(...popSnippetWindowBuffer())\n  flushSetAnonymousID(analytics, buffer)\n  flushOn(analytics, buffer)\n}\n\n/**\n * Finish flushing buffer and cleanup.\n */\nasync function flushFinalBuffer(\n  analytics: Analytics,\n  buffer: PreInitMethodCallBuffer\n): Promise<void> {\n  // Call popSnippetWindowBuffer before each flush task since there may be\n  // analytics calls during async function calls.\n  buffer.push(...popSnippetWindowBuffer())\n  await flushAddSourceMiddleware(analytics, buffer)\n  buffer.push(...popSnippetWindowBuffer())\n  flushAnalyticsCallsInNewTask(analytics, buffer)\n  // Clear buffer, just in case analytics is loaded twice; we don't want to fire events off again.\n  buffer.clear()\n}\n\nasync function registerPlugins(\n  legacySettings: LegacySettings,\n  analytics: Analytics,\n  opts: InitOptions,\n  options: InitOptions,\n  plugins: Plugin[],\n  legacyIntegrationSources: ClassicIntegrationSource[]\n): Promise<Context> {\n  const tsubMiddleware = hasTsubMiddleware(legacySettings)\n    ? await import(\n        /* webpackChunkName: \"tsub-middleware\" */ '../plugins/routing-middleware'\n      ).then((mod) => {\n        return mod.tsubMiddleware(\n          legacySettings.middlewareSettings!.routingRules\n        )\n      })\n    : undefined\n\n  const legacyDestinations =\n    hasLegacyDestinations(legacySettings) || legacyIntegrationSources.length > 0\n      ? await import(\n          /* webpackChunkName: \"ajs-destination\" */ '../plugins/ajs-destination'\n        ).then((mod) => {\n          return mod.ajsDestinations(\n            legacySettings,\n            analytics.integrations,\n            opts,\n            tsubMiddleware,\n            legacyIntegrationSources\n          )\n        })\n      : []\n\n  if (legacySettings.legacyVideoPluginsEnabled) {\n    await import(\n      /* webpackChunkName: \"legacyVideos\" */ '../plugins/legacy-video-plugins'\n    ).then((mod) => {\n      return mod.loadLegacyVideoPlugins(analytics)\n    })\n  }\n\n  const schemaFilter = opts.plan?.track\n    ? await import(\n        /* webpackChunkName: \"schemaFilter\" */ '../plugins/schema-filter'\n      ).then((mod) => {\n        return mod.schemaFilter(opts.plan?.track, legacySettings)\n      })\n    : undefined\n\n  const mergedSettings = mergedOptions(legacySettings, options)\n  const remotePlugins = await remoteLoader(\n    legacySettings,\n    analytics.integrations,\n    mergedSettings,\n    options.obfuscate,\n    tsubMiddleware\n  ).catch(() => [])\n\n  const toRegister = [\n    validation,\n    pageEnrichment,\n    ...plugins,\n    ...legacyDestinations,\n    ...remotePlugins,\n  ]\n\n  if (schemaFilter) {\n    toRegister.push(schemaFilter)\n  }\n\n  const shouldIgnoreSegmentio =\n    (opts.integrations?.All === false && !opts.integrations['Segment.io']) ||\n    (opts.integrations && opts.integrations['Segment.io'] === false)\n\n  if (!shouldIgnoreSegmentio) {\n    toRegister.push(\n      segmentio(\n        analytics,\n        mergedSettings['Segment.io'] as SegmentioSettings,\n        legacySettings.integrations\n      )\n    )\n  }\n\n  const ctx = await analytics.register(...toRegister)\n\n  if (\n    Object.entries(legacySettings.enabledMiddleware ?? {}).some(\n      ([, enabled]) => enabled\n    )\n  ) {\n    await import(\n      /* webpackChunkName: \"remoteMiddleware\" */ '../plugins/remote-middleware'\n    ).then(async ({ remoteMiddlewares }) => {\n      const middleware = await remoteMiddlewares(\n        ctx,\n        legacySettings,\n        options.obfuscate\n      )\n      const promises = middleware.map((mdw) =>\n        analytics.addSourceMiddleware(mdw)\n      )\n      return Promise.all(promises)\n    })\n  }\n\n  return ctx\n}\n\nasync function loadAnalytics(\n  settings: AnalyticsBrowserSettings,\n  options: InitOptions = {},\n  preInitBuffer: PreInitMethodCallBuffer\n): Promise<[Analytics, Context]> {\n  // this is an ugly side-effect, but it's for the benefits of the plugins that get their cdn via getCDN()\n  if (settings.cdnURL) setGlobalCDNUrl(settings.cdnURL)\n\n  const legacySettings =\n    settings.cdnSettings ??\n    (await loadLegacySettings(settings.writeKey, settings.cdnURL))\n\n  const retryQueue: boolean =\n    legacySettings.integrations['Segment.io']?.retryQueue ?? true\n\n  const opts: InitOptions = { retryQueue, ...options }\n  const analytics = new Analytics(settings, opts)\n\n  attachInspector(analytics)\n\n  const plugins = settings.plugins ?? []\n  const classicIntegrations = settings.classicIntegrations ?? []\n  Stats.initRemoteMetrics(legacySettings.metrics)\n\n  // needs to be flushed before plugins are registered\n  flushPreBuffer(analytics, preInitBuffer)\n\n  const ctx = await registerPlugins(\n    legacySettings,\n    analytics,\n    opts,\n    options,\n    plugins,\n    classicIntegrations\n  )\n\n  const search = window.location.search ?? ''\n  const hash = window.location.hash ?? ''\n\n  const term = search.length ? search : hash.replace(/(?=#).*(?=\\?)/, '')\n\n  if (term.includes('ajs_')) {\n    await analytics.queryString(term).catch(console.error)\n  }\n\n  analytics.initialized = true\n  analytics.emit('initialize', settings, options)\n\n  if (options.initialPageview) {\n    analytics.page().catch(console.error)\n  }\n\n  await flushFinalBuffer(analytics, preInitBuffer)\n\n  return [analytics, ctx]\n}\n\n/**\n * The public browser interface for Segment Analytics\n *\n * @example\n * ```ts\n *  export const analytics = new AnalyticsBrowser()\n *  analytics.load({ writeKey: 'foo' })\n * ```\n * @link https://github.com/segmentio/analytics-next/#readme\n */\nexport class AnalyticsBrowser extends AnalyticsBuffered {\n  private _resolveLoadStart: (\n    settings: AnalyticsBrowserSettings,\n    options: InitOptions\n  ) => void\n\n  constructor() {\n    const { promise: loadStart, resolve: resolveLoadStart } =\n      createDeferred<Parameters<AnalyticsBrowser['load']>>()\n\n    super((buffer) =>\n      loadStart.then(([settings, options]) =>\n        loadAnalytics(settings, options, buffer)\n      )\n    )\n\n    this._resolveLoadStart = (settings, options) =>\n      resolveLoadStart([settings, options])\n  }\n\n  /**\n   * Fully initialize an analytics instance, including:\n   *\n   * * Fetching settings from the segment CDN (by default).\n   * * Fetching all remote destinations configured by the user (if applicable).\n   * * Flushing buffered analytics events.\n   * * Loading all middleware.\n   *\n   * Note:  This method should only be called *once* in your application.\n   *\n   * @example\n   * ```ts\n   * export const analytics = new AnalyticsBrowser()\n   * analytics.load({ writeKey: 'foo' })\n   * ```\n   */\n  load(\n    settings: AnalyticsBrowserSettings,\n    options: InitOptions = {}\n  ): AnalyticsBrowser {\n    this._resolveLoadStart(settings, options)\n    return this\n  }\n\n  /**\n   * Instantiates an object exposing Analytics methods.\n   *\n   * @example\n   * ```ts\n   * const ajs = AnalyticsBrowser.load({ writeKey: '<YOUR_WRITE_KEY>' })\n   *\n   * ajs.track(\"foo\")\n   * ...\n   * ```\n   */\n  static load(\n    settings: AnalyticsBrowserSettings,\n    options: InitOptions = {}\n  ): AnalyticsBrowser {\n    return new AnalyticsBrowser().load(settings, options)\n  }\n\n  static standalone(\n    writeKey: string,\n    options?: InitOptions\n  ): Promise<Analytics> {\n    return AnalyticsBrowser.load({ writeKey }, options).then((res) => res[0])\n  }\n}\n", "export class AnalyticsNode {\n  static load(): Promise<never> {\n    return Promise.reject(\n      new Error('AnalyticsNode is not available in browsers.')\n    )\n  }\n}\n"],
  "mappings": "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",
  "names": ["undefined", "hex", "_a", "_b", "EventFactory", "_a", "_b", "md5", "EventQueue", "Analytics", "_a", "_b", "plugin", "_a", "ActionDestination", "_a", "_b", "_a", "_b", "plugin", "batch", "_a", "_b", "scheduleFlush", "dispatch", "dispatch", "_a", "scheduleFlush", "_b", "_a", "segmentio", "validate", "_a", "_a", "_b", "PreInitMethodCallBuffer", "_a", "AnalyticsBuffered", "_a", "_a", "_b", "_a", "AnalyticsBrowser", "AnalyticsNode"]
}
